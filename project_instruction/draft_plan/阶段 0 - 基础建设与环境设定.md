这个阶段的核心目标是搭建一个功能完备、流程自动化的本地开发环境。我们将建立前端、后端项目的基础结构，配置好数据库和版本控制，并确保各个部分能够协同工作。

#### **1. 开发环境与工具链准备 (Prerequisites & Tooling)**

**目标**：确保所有开发人员的本地环境一致，安装所有必需的软件。

- **1.1. 安装 Node.js**: 确保您已安装 `Node.js` (建议 LTS 版本，如 18.x 或 20.x) 和 `npm` 或 `yarn`。
    
- **1.2. 安装代码编辑器**: 推荐使用 `Visual Studio Code`，并安装以下推荐插件：
    
    - `ESLint`: 用于代码规范检查。
        
    - `Prettier`: 用于代码格式化。
        
    - `Prisma`: (我们将在后端使用) 用于简化数据库操作。
        
    - `Tailwind CSS IntelliSense`: (我们将在前端使用) 用于提升CSS编写效率。
        
- **1.3. 安装 Git & GitHub CLI**:
    
    - 安装 `Git` 用于版本控制。
        
    - 安装 `GitHub CLI` (`gh`)，这将简化与 GitHub 的交互，如创建仓库、PR等。
        
- **1.4. 安装 Docker Desktop**: 用于在本地快速启动和管理数据库 (PostgreSQL) 和其他服务 (如 MinIO)。
    
- **1.5. 启动 n8n**: 确保您的 n8n 实例已在本地 `localhost:5678` 成功运行。
    

#### **2. 项目结构与后端 (Nest.js) 初始化**

**目标**：创建一个结构清晰的单体仓库 (Monorepo)，并建立后端应用的基础。

- **2.1. 创建项目根目录**: 在您的开发目录下创建一个新的文件夹，例如 `case-management-system`。
    
- **2.2. 初始化后端项目**:
    
    - 在根目录中，使用 NestJS CLI 创建后端项目： `npx @nestjs/cli new backend`。
        
    - 进入 `backend` 目录，安装必要的依赖：
        
        - `@nestjs/config`: 用于环境变数管理。
            
        - `@nestjs/swagger`: 用于自动生成 API 文档。
            
        - `prisma`: 用于数据库 ORM。
            
        - `pg`: PostgreSQL 驱动。
            
- **2.3. 配置数据库 (Docker & Prisma)**:
    
    - 在项目根目录创建 `docker-compose.yml` 文件，配置 PostgreSQL 服务。
        
    - 运行 `docker-compose up -d` 启动数据库。
        
    - 在 `backend` 目录中，运行 `npx prisma init --datasource-provider postgresql` 初始化 Prisma。
        
    - 在 `prisma/schema.prisma` 文件中，根据您的 ERD (`02_entity relationship diagram.pdf`) 定义 `User`, `Case`, 和 `Case_Log` 模型。
        
    - 运行 `npx prisma migrate dev --name init` 创建初始的数据库表结构。
        

#### **3. 前端 (Next.js) 初始化与样式配置**

**目标**：建立响应式前端应用的基础，并配置好UI框架。

- **3.1. 初始化前端项目**:
    
    - 在项目根目录中，使用 Next.js CLI 创建前端项目：`npx create-next-app@latest frontend`。
        
    - 在创建过程中，请选择使用 `TypeScript` 和 `Tailwind CSS`。
        
- **3.2. 配置UI组件库**:
    
    - 为了快速构建美观且响应式的界面，我建议集成一个组件库，例如 `shadcn/ui`。
        
    - 根据 `shadcn/ui` 的官方文档，在 `frontend` 目录中进行初始化配置。
        
- **3.3. 创建响应式布局**:
    
    - 创建一个基本的 `Layout` 组件，包含页眉 (Header)、主要内容区 (Main Content) 和页脚 (Footer)。
        
    - 使用 Tailwind CSS 的断点 (`sm`, `md`, `lg`) 来确保布局在手机和电脑屏幕上都能良好显示。
        

#### **4. 版本控制与协作 (Git & GitHub)**

**目标**：建立代码的版本控制流程，为团队协作打下基础。

- **4.1. 创建 GitHub 仓库**:
    
    - 使用 GitHub CLI: `gh repo create case-management-system --public --source=. --remote=origin`。
        
    - 这将会在您的 GitHub 账户下创建一个新的仓库，并将本地代码推送上去。
        
- **4.2. 配置 `.gitignore`**: 确保 `node_modules`, `.env`, `dist` 等不需要版本控制的文件和目录被忽略。
    
- **4.3. 建立分支策略**:
    
    - 建议采用 `Git Flow` 的简化版：
        
        - `main`: 用于生产部署的分支。
            
        - `develop`: 用于集成所有功能开发的预发布分支。
            
        - `feature/xxx`: 用于开发具体功能的分支 (例如: `feature/user-auth`)。
            
    - 在 GitHub 仓库设置中，将 `main` 和 `develop` 分支设置为保护分支，防止直接推送。所有合并都必须通过 Pull Request (PR)。
        

#### **5. "Hello World" 端到端测试**

**目标**：验证前后端能够成功通信，n8n可以被调用。

- **5.1. 后端创建API端点**: 在 Nest.js (`backend`) 中，创建一个简单的 `GET /api/health` 端点，返回 `{ status: 'ok' }`。
    
- **5.2. 前端调用API**: 在 Next.js (`frontend`) 的首页中，使用 `fetch` 或 `axios` 调用后端的 `/api/health` 端点，并将返回的状态显示在页面上。
    
- **5.3. n8n 集成测试**:
    
    - 在 n8n 中，创建一个简单的 Webhook 节点。
        
    - 在 Nest.js 中，创建一个 `GET /api/n8n-test` 端点，该端点会向 n8n 的 Webhook URL 发送一个请求。
        
    - 通过访问 `/api/n8n-test` 来触发这个流程，并检查 n8n 是否成功接收到数据。
        

完成以上所有步骤后，我们就拥有了一个坚实的项目基础。您可以随时将代码推送到 GitHub，并且本地的开发、测试、自动化流程已经初步打通。